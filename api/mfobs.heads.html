

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The head observations module &mdash; modflow-obs 0.post3.dev0+g95c29c1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MODFLOW-related functions" href="mfobs.modflow.html" />
    <link rel="prev" title="Modules" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> modflow-obs
          

          
          </a>

          
            
            
              <div class="version">
                0.post3.dev0+g95c29c1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../philosophy.html">Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/Example.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/Example.html"> Demo of Modflow-obs</a></li>
</ul>
<p class="caption"><span class="caption-text">Code reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html"> Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Head observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="mfobs.modflow.html">MODFLOW-related functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="mfobs.utils.html">Utility functions</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Release history</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release-history.html"> Release History</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to modflow-obs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">modflow-obs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Modules</a> &raquo;</li>
        
      <li>The head observations module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/mfobs.heads.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-mfobs.heads">
<span id="the-head-observations-module"></span><h1>The head observations module<a class="headerlink" href="#module-mfobs.heads" title="Permalink to this headline">¶</a></h1>
<p>Functions for processing head observations</p>
<dl class="py function">
<dt id="mfobs.heads.get_head_obs">
<code class="sig-prename descclassname">mfobs.heads.</code><code class="sig-name descname">get_head_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">perioddata</span></em>, <em class="sig-param"><span class="n">modelgrid_transform</span></em>, <em class="sig-param"><span class="n">model_output_file</span></em>, <em class="sig-param"><span class="n">observed_values_file</span></em>, <em class="sig-param"><span class="n">gwf_obs_input_file</span></em>, <em class="sig-param"><span class="n">observed_values_metadata_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">variable_name</span><span class="o">=</span><span class="default_value">'head'</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">'processed_head_obs.dat'</span></em>, <em class="sig-param"><span class="n">observed_values_site_id_col</span><span class="o">=</span><span class="default_value">'obsprefix'</span></em>, <em class="sig-param"><span class="n">observed_values_datetime_col</span><span class="o">=</span><span class="default_value">'datetime'</span></em>, <em class="sig-param"><span class="n">obsnme_date_suffix_format</span><span class="o">=</span><span class="default_value">'%Y%m'</span></em>, <em class="sig-param"><span class="n">observed_values_obsval_col</span><span class="o">=</span><span class="default_value">'obsval'</span></em>, <em class="sig-param"><span class="n">observed_values_x_col</span><span class="o">=</span><span class="default_value">'x'</span></em>, <em class="sig-param"><span class="n">observed_values_y_col</span><span class="o">=</span><span class="default_value">'y'</span></em>, <em class="sig-param"><span class="n">observed_values_screen_top_col</span><span class="o">=</span><span class="default_value">'screen_top'</span></em>, <em class="sig-param"><span class="n">observed_values_screen_botm_col</span><span class="o">=</span><span class="default_value">'screen_botm'</span></em>, <em class="sig-param"><span class="n">observed_values_layer_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">observed_values_group_column</span><span class="o">=</span><span class="default_value">'group'</span></em>, <em class="sig-param"><span class="n">observed_values_unc_column</span><span class="o">=</span><span class="default_value">'uncertainty'</span></em>, <em class="sig-param"><span class="n">aggregrate_observed_values_by</span><span class="o">=</span><span class="default_value">'mean'</span></em>, <em class="sig-param"><span class="n">drop_groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">hk_arrays</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">top_array</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">botm_arrays</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label_period_as_steady_state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">steady_state_period_start</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">steady_state_period_end</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">write_ins</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfobs/heads.html#get_head_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfobs.heads.get_head_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>Post-processes model output to be read by PEST, and optionally,
writes a corresponding PEST instruction file. Reads model output
using get_mf6_single_variable_obs(). General paradigm is to include all model
layers in the MODFLOW input for each observation, and then post-process the model
results to a single value by computing a transmissivity-weighted average.</p>
<p>Observation names to match observed values to their simulated equivalents are constructed
in the format of &lt;obsprefix&gt;_&lt;date suffix&gt;, where obsprefix is a site identifier taken
from the <code class="docutils literal notranslate"><span class="pre">observed_values_site_id_col</span></code> in <code class="docutils literal notranslate"><span class="pre">observed_values_file</span></code>. In creating
observation names for MODFLOW output, the column names in the observation CSV output
are used for the prefixes. Therefore, the identifiers in <code class="docutils literal notranslate"><span class="pre">observed_values_site_id_col</span></code>
should correspond to observations in the MODFLOW observation input. The date suffix
is formatted using the <code class="docutils literal notranslate"><span class="pre">obsnme_date_suffix_format</span></code> parameter, which is also
passed to <a class="reference internal" href="mfobs.modflow.html#mfobs.modflow.get_mf6_single_variable_obs" title="mfobs.modflow.get_mf6_single_variable_obs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_mf6_single_variable_obs()</span></code></a> for assigning observation
names to the MODFLOW observation output.</p>
<p>Optionally, a model stress period can be labeled as steady-state (<code class="docutils literal notranslate"><span class="pre">label_period_as_steady_state</span></code>),
representing average conditions over a time period bracked by a <code class="docutils literal notranslate"><span class="pre">steady_state_period_start</span></code> and
<code class="docutils literal notranslate"><span class="pre">steady_state_period_end</span></code>. In this case, the simulated values for the labeled stress period are
matched to average values for the steady-state time period.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>perioddata</strong><span class="classifier">str</span></dt><dd><p>Path to csv file with start/end dates for stress periods. Must have columns
‘time’ (modflow time, in days), ‘start_datetime’ (start date for the stress period)
and ‘end_datetime’ (end date for the stress period).</p>
</dd>
<dt><strong>modelgrid_transform</strong><span class="classifier">str</span></dt><dd><p>An <a class="reference external" href="https://github.com/sgillies/affine">affine.Affine</a> object describing the orientation
of the model grid. Modflow-setup <a class="reference external" href="https://aleaf.github.io/modflow-setup/api/mfsetup.grid.html#mfsetup.grid.MFsetupGrid" title="(in modflow-setup v0.post51+gd4dca5a)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFsetupGrid</span></code></a> have this attached
via the <a class="reference external" href="https://aleaf.github.io/modflow-setup/api/mfsetup.grid.html#mfsetup.grid.MFsetupGrid.transform" title="(in modflow-setup v0.post51+gd4dca5a)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform()</span></code></a> property. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid_transform</span><span class="o">=</span><span class="n">affine</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">500955</span><span class="p">,</span>
                                  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mi">1205285</span><span class="p">)</span>
</pre></div>
</div>
<p>for a uniform spacing of 1000 and upper left corner of 500955, 1205285
with a rotation of 45 degrees, counter-clockwise about the upper left corner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid_transform</span><span class="o">=</span><span class="n">affine</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">500955</span><span class="p">,</span>
                                  <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mi">1205285</span><span class="p">)</span><span class="o">.</span><span class="n">rotation</span><span class="p">(</span><span class="mf">45.</span><span class="p">)</span>
</pre></div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">affine.Affine</span></code> instance can also be created from a
<a class="reference external" href="https://github.com/aleaf/modflow-setup">Modflow-setup</a>
grid JSON file via the <a class="reference internal" href="mfobs.modflow.html#mfobs.modflow.get_modelgrid_transform" title="mfobs.modflow.get_modelgrid_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_modelgrid_transform()</span></code></a> function.</p>
</dd>
<dt><strong>model_output_file</strong><span class="classifier">str</span></dt><dd><p>Modflow-6 head observation CSV output file.
Read by <a class="reference internal" href="mfobs.modflow.html#mfobs.modflow.get_mf6_single_variable_obs" title="mfobs.modflow.get_mf6_single_variable_obs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_mf6_single_variable_obs()</span></code></a>.</p>
</dd>
<dt><strong>observed_values_file</strong><span class="classifier">str or DataFrame</span></dt><dd><p>CSV file or DataFrame with observed values. Must have the following columns
(default names are shown, other names can be specified with
observed_values_**_col variables below):</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>site_id</p></td>
<td><p>site identifier</p></td>
</tr>
<tr class="row-even"><td><p>datetime</p></td>
<td><p>date/time of observation</p></td>
</tr>
<tr class="row-odd"><td><p>obsval</p></td>
<td><p>observed value</p></td>
</tr>
</tbody>
</table>
<p>can optionally include these columns, or this information can be supplied
in an observed_values_metadata_file, which will be joined on site_id</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>x</p></td>
<td><p>x location</p></td>
</tr>
<tr class="row-even"><td><p>y</p></td>
<td><p>y location</p></td>
</tr>
<tr class="row-odd"><td><p>screen_top</p></td>
<td><p>screen top elevation</p></td>
</tr>
<tr class="row-even"><td><p>screen_botm</p></td>
<td><p>screen bottom elevation</p></td>
</tr>
</tbody>
</table>
<p>If supplied, observation group an uncertainty information will be
passed through to the output <code class="docutils literal notranslate"><span class="pre">head_obs</span></code> DataFrame:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>group</p></td>
<td><p>observation group</p></td>
</tr>
<tr class="row-even"><td><p>uncertainty</p></td>
<td><p>estimated measurement uncertainty</p></td>
</tr>
</tbody>
</table>
<p>Locations and screen tops and bottoms are assumed to be in the same
CRS and length units as the model.</p>
</dd>
<dt><strong>observed_values_metadata_file</strong><span class="classifier">str, optional</span></dt><dd><p>Site information for the observed values timeseries. Should include a
<cite>site_id</cite> column that is the same as observed_values_site_id_col, and any of
the following columns that are not in the observed_values_file:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>x</p></td>
<td><p>x location</p></td>
</tr>
<tr class="row-even"><td><p>y</p></td>
<td><p>y location</p></td>
</tr>
<tr class="row-odd"><td><p>screen_top</p></td>
<td><p>screen top elevation</p></td>
</tr>
<tr class="row-even"><td><p>screen_botm</p></td>
<td><p>screen bottom elevation</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><strong>gwf_obs_input_file</strong><span class="classifier">str</span></dt><dd><p>Input file to MODFLOW-6 observation utility (contains layer information).</p>
</dd>
<dt><strong>variable_name</strong><span class="classifier">str, optional</span></dt><dd><p>Column with simulated output will be named “sim_&lt;variable_name”,
by default ‘head’</p>
</dd>
<dt><strong>outfile</strong><span class="classifier">str, optional</span></dt><dd><p>Output file of values to be read by PEST,
by default ‘processed_head_obs.dat’</p>
</dd>
<dt><strong>observed_values_site_id_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with site identifiers,
by default ‘obsprefix’</p>
</dd>
<dt><strong>observed_values_datetime_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with observation date/times,
by default ‘datetime’</p>
</dd>
<dt><strong>obsnme_date_suffix_format</strong><span class="classifier">str, optional</span></dt><dd><p>Format for date suffix of obsnmes. By default, ‘%Y%m’,
which would yield ‘202001’ for a Jan, 2020 observation.
Observation names are created following the format of
&lt;obsprefix&gt;_&lt;date suffix&gt;</p>
</dd>
<dt><strong>observed_values_obsval_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with observed values,
by default ‘obsval’</p>
</dd>
<dt><strong>observed_values_x_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with x-coordinates,
by default ‘x’</p>
</dd>
<dt><strong>observed_values_y_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with y-coordinates,
by default ‘y’</p>
</dd>
<dt><strong>observed_values_screen_top_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with screen top elevations,
by default ‘screen_top’</p>
</dd>
<dt><strong>observed_values_screen_botm_col</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with screen bottom elevations,
by default ‘screen_botm’</p>
</dd>
<dt><strong>observed_values_layer_col</strong><span class="classifier">str, optional</span></dt><dd><p>As an alternative to providing screen tops and bottoms, the model layer
for each observation can be specified directly via a layer column
of zero-based layer numbers.
by default None</p>
</dd>
<dt><strong>observed_values_group_column</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with observation group information.
Passed through to output <code class="docutils literal notranslate"><span class="pre">head_obs</span></code> DataFrame, otherwise not required.
by default ‘group’</p>
</dd>
<dt><strong>observed_values_unc_column</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in observed_values_file with observation uncertainty values.
Passed through to output <code class="docutils literal notranslate"><span class="pre">head_obs</span></code> DataFrame, otherwise not required.
by default ‘uncertainty’</p>
</dd>
<dt><strong>aggregrate_observed_values_by</strong><span class="classifier">str</span></dt><dd><p>Method for aggregating observed values to the model stress periods,
if there are multiple observed values in a stress period. Can be any
of the method calls on the pandas
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/resampling.html">Resampler</a>
object. By default, ‘mean’</p>
</dd>
<dt><strong>drop_groups</strong><span class="classifier">sequence, optional</span></dt><dd><p>Observation groups to exclude from output, by default None</p>
</dd>
<dt><strong>hk_arrays</strong><span class="classifier">list-like, optional</span></dt><dd><p>File paths to text arrays with hydraulic conductivity values
(ordered by model layer). Used in the transmissivity-weighted averaging.
by default None</p>
</dd>
<dt><strong>top_array</strong><span class="classifier">str, optional</span></dt><dd><p>File paths to text array with model top elevations.
Used in the transmissivity-weighted averaging.
by default None</p>
</dd>
<dt><strong>botm_arrays</strong><span class="classifier">str, optional</span></dt><dd><p>File paths to text arrays with model cell bottom elevations.
(ordered by model layer). Used in the transmissivity-weighted averaging.
by default None</p>
</dd>
<dt><strong>label_period_as_steady_state</strong><span class="classifier">int, optional</span></dt><dd><p>Zero-based model stress period where observations will be
assigned the suffix ‘ss’ instead of a date suffix.
By default, None, in which case all model output is assigned
a date suffix based on the start date of the stress period.
Passed to <a class="reference internal" href="mfobs.modflow.html#mfobs.modflow.get_mf6_single_variable_obs" title="mfobs.modflow.get_mf6_single_variable_obs"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_mf6_single_variable_obs()</span></code></a>.</p>
</dd>
<dt><strong>steady_state_period_start</strong><span class="classifier">str, optional</span></dt><dd><p>Start date for the period representing steady-state conditions.
Observations between <code class="docutils literal notranslate"><span class="pre">steady_state_period_start</span></code> and <code class="docutils literal notranslate"><span class="pre">steady_state_period_end</span></code>
will be averaged to create additional observations with the suffix ‘ss’.
The steady-state averages will be matched to model output from the
stress period specified by <code class="docutils literal notranslate"><span class="pre">label_period_as_steady_state</span></code>.
By default None, in which case no steady-state observatons are created.</p>
</dd>
<dt><strong>steady_state_period_end</strong><span class="classifier">str, optional</span></dt><dd><p>End date for the period representing steady-state conditions.
By default None, in which case no steady-state observatons are created.</p>
</dd>
<dt><strong>write_ins</strong><span class="classifier">bool, optional</span></dt><dd><p>Option to write instruction file, by default False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>head_obs</strong><span class="classifier">DataFrame</span></dt><dd><p>With the following columns:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>datetime</p></td>
<td><p>pandas datetimes for the start of each stress period</p></td>
</tr>
<tr class="row-even"><td><p>per</p></td>
<td><p>model stress period</p></td>
</tr>
<tr class="row-odd"><td><p>obsprefix</p></td>
<td><p>observation site identifier</p></td>
</tr>
<tr class="row-even"><td><p>obsnme</p></td>
<td><p>observation name based on format of &lt;obsprefix&gt;_’%Y%m’</p></td>
</tr>
<tr class="row-odd"><td><p>obs_&lt;variable_name&gt;</p></td>
<td><p>observed values</p></td>
</tr>
<tr class="row-even"><td><p>sim_&lt;variable_name&gt;</p></td>
<td><p>simulated observation equivalents</p></td>
</tr>
<tr class="row-odd"><td><p>screen_top</p></td>
<td><p>screen top elevation</p></td>
</tr>
<tr class="row-even"><td><p>screen_botm</p></td>
<td><p>screen bottom elevation</p></td>
</tr>
</tbody>
</table>
<p>Example observation names:</p>
<p>site1000_202001, for a Jan. 2020 observation at site1000</p>
<p>steady-state stress periods are given the suffix of ‘ss’
e.g. site1000_ss</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All observation names and observation prefixes are converted to lower case
to avoid potential case issues.</p>
</dd></dl>

<dl class="py function">
<dt id="mfobs.heads.get_spatial_head_differences">
<code class="sig-prename descclassname">mfobs.heads.</code><code class="sig-name descname">get_spatial_head_differences</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">head_obs</span></em>, <em class="sig-param"><span class="n">perioddata</span></em>, <em class="sig-param"><span class="n">lake_head_difference_sites</span></em>, <em class="sig-param"><span class="n">head_obs_values_col</span><span class="o">=</span><span class="default_value">'obs_head'</span></em>, <em class="sig-param"><span class="n">head_sim_values_col</span><span class="o">=</span><span class="default_value">'sim_head'</span></em>, <em class="sig-param"><span class="n">obs_diff_value_col</span><span class="o">=</span><span class="default_value">'obsval'</span></em>, <em class="sig-param"><span class="n">sim_diff_values_col</span><span class="o">=</span><span class="default_value">'sim_obsval'</span></em>, <em class="sig-param"><span class="n">use_gradients</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">write_ins</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfobs/heads.html#get_spatial_head_differences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfobs.heads.get_spatial_head_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the head_obs dataframe output by get_head_obs_near_lakes, and
maybe some other input, and creates spatial head difference observations
at locations where there are vertical head difference, and writes them
to a csv file in tables/.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>head_obs</strong><span class="classifier">DataFrame</span></dt><dd><p>Table of preprocessed head observations</p>
</dd>
<dt><strong>lake_head_difference_sites</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of lake site numbers (keys) and gw level sites (values) to compare.
Values is list of strings; observations containing these strings will be compared
to lake stage on the date of measurement.</p>
</dd>
<dt><strong>use_gradients</strong><span class="classifier">bool</span></dt><dd><p>If True, use hydraulic gradients, if False, use vertical head differences.
By default False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mfobs.heads.get_temporal_head_difference_obs">
<code class="sig-prename descclassname">mfobs.heads.</code><code class="sig-name descname">get_temporal_head_difference_obs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">head_obs</span></em>, <em class="sig-param"><span class="n">perioddata</span></em>, <em class="sig-param"><span class="n">head_obs_values_col</span><span class="o">=</span><span class="default_value">'obs_head'</span></em>, <em class="sig-param"><span class="n">head_sim_values_col</span><span class="o">=</span><span class="default_value">'sim_head'</span></em>, <em class="sig-param"><span class="n">obs_diff_value_col</span><span class="o">=</span><span class="default_value">'obsval'</span></em>, <em class="sig-param"><span class="n">sim_diff_values_col</span><span class="o">=</span><span class="default_value">'sim_obsval'</span></em>, <em class="sig-param"><span class="n">exclude_suffix</span><span class="o">=</span><span class="default_value">'ss'</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">write_ins</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfobs/heads.html#get_temporal_head_difference_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfobs.heads.get_temporal_head_difference_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the head_obs dataframe output by get_head_obs,
creates temporal head difference observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>head_obs</strong><span class="classifier">DataFrame</span></dt><dd><p>Head observation data with same column structure as
output from <a class="reference internal" href="#mfobs.heads.get_head_obs" title="mfobs.heads.get_head_obs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mfobs.heads.get_head_obs()</span></code></a></p>
</dd>
<dt><strong>head_obs_values_col</strong><span class="classifier">str</span></dt><dd><p>Column in head_obs with observed values to difference.
By default, ‘obs_head’</p>
</dd>
<dt><strong>head_sim_values_col</strong><span class="classifier">str</span></dt><dd><p>Column in head_obs with simulated values to difference.
By default, ‘sim_head`</p>
</dd>
<dt><strong>obs_diff_value_col</strong><span class="classifier">str</span></dt><dd><p>Name of column with computed observed differences.
By default, ‘obsval’</p>
</dd>
<dt><strong>sim_diff_values_col</strong><span class="classifier">str</span></dt><dd><p>Name of column with computed simulated differences.
By default, ‘sim_obsval’</p>
</dd>
<dt><strong>exclude_suffix</strong><span class="classifier">str or list-like</span></dt><dd><p>Option to exclude observations from differencing by suffix;
e.g. ‘ss’ to include steady-state observations.
By default, ‘ss’</p>
</dd>
<dt><strong>outfile</strong><span class="classifier">str, optional</span></dt><dd><p>CSV file to write output to.
By default, None (no output written)</p>
</dd>
<dt><strong>write_ins</strong><span class="classifier">bool, optional</span></dt><dd><p>Option to write instruction file, by default False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>period_diffs</strong><span class="classifier">DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mfobs.modflow.html" class="btn btn-neutral float-right" title="MODFLOW-related functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Oct 13, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>